@if (isLoading()) {
  <div class="builder-loading">
    <dc-spinner text="Loading brand and configs..." size="large" [fullHeight]="true"></dc-spinner>
  </div>
} @else if (error()) {
  <div class="builder-error">
    <img src="/assets/dino-think.svg" alt="Dino Thinking" class="dino-thinking" />
    <h2>Error</h2>
    <p>{{ error() }}</p>
    <button class="btn primary" (click)="goToBrands()">
      Back to Brand Selection
    </button>
  </div>
} @else {
  <div class="multi-config-builder">
    <div class="main-layout">
      <dc-brand-header [brand]="brand()"></dc-brand-header>

      @if (limitReached() && subscription()) {
        <div class="limit-warning-container">
          <dc-subscription-limit-warning 
            [message]="limitErrorMessage() || 'You\'ve reached your config limit'"
            [currentTier]="subscription()!.tier"
          ></dc-subscription-limit-warning>
        </div>
      }

      <div class="main-content">
        <dc-config-sidebar
          [configDefinitions]="configDefinitions()"
          [selectedDefinitionId]="selectedDefinitionId()"
          (selected)="onConfigSelect($event)"
          (deleted)="onConfigDelete($event)"
          (renamed)="onConfigRename($event)"
          (created)="onConfigCreate($event)"
        ></dc-config-sidebar>

        <div class="config-content">
          @if (selectedDefinitionId()) {
            <router-outlet></router-outlet>
          } @else {
            <div class="config-builder-panel dragdrop-mode">
              <div class="panel-header">
                <h3 class="section-title">Configuration Builder</h3>
                <p class="section-subtitle">Create or select a config to get started</p>
              </div>
              <div class="builder-disabled">
                <div class="empty-state">
                  <img src="/assets/dino-sad.svg" alt="No configuration selected" class="empty-icon-svg" />
                  <h4>No Configuration Selected</h4>
                  <p>Please create or select a configuration from the sidebar to start building your form.</p>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
}

