<dc-auth-layout
  title="Sign in to DinoConfig"
  description="Welcome back! Please enter your details."
  sidebarTitle="Welcome to DinoConfig"
  sidebarDescription="Manage your configurations with ease and confidence."
>
  @if (error()) {
    <div class="bg-red-50 border border-red-200 text-red-600 py-3 px-4 rounded-lg mb-6 text-sm leading-relaxed">
      {{ error() }}
    </div>
  }

  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-6">
    <mat-form-field appearance="outline">
      <mat-label>Email</mat-label>
      <input matInput
        type="email"
        formControlName="email"
        placeholder="Enter your email"
        required
        autocomplete="email"
      />
      @if (loginForm.get('email')?.hasError('required') && loginForm.get('email')?.touched) {
        <mat-error>Email is required</mat-error>
      }
      @if (loginForm.get('email')?.hasError('email') && loginForm.get('email')?.touched) {
        <mat-error>Please enter a valid email address</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Password</mat-label>
      <input matInput
        [type]="showPassword() ? 'text' : 'password'"
        formControlName="password"
        placeholder="Enter your password"
        required
        autocomplete="current-password"
      />
      <button mat-icon-button matSuffix
        type="button"
        (click)="togglePasswordVisibility()"
        [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'"
      >
        @if (showPassword()) {
          <mat-icon>visibility_off</mat-icon>
        } @else {
          <mat-icon>visibility</mat-icon>
        }
      </button>
      @if (loginForm.get('password')?.hasError('required') && loginForm.get('password')?.touched) {
        <mat-error>Password is required</mat-error>
      }
    </mat-form-field>

    <button mat-raised-button
      type="submit"
      color="primary"
      class="w-full"
      [disabled]="isLoading() || loginForm.invalid"
    >   
      @if (isLoading()) {
        <mat-icon>
          <mat-spinner diameter="20"></mat-spinner>
        </mat-icon> 
      }
      Sign In
    </button>
  </form>

  <div class="mt-8 text-center text-sm text-slate-500">
    <p>
      Don't have an account?
      <a routerLink="/signup" class="text-blue-500 no-underline font-semibold transition-colors hover:text-blue-600 hover:underline">
        Sign up
      </a>
    </p>
  </div>
</dc-auth-layout>
